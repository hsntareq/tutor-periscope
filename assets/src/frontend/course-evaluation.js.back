/**
 * Student course evaluation
 *
 * @since v1.0.0
 */
import ajaxRequest from "./ajax";
const { __ } = wp.i18n;
document.addEventListener("DOMContentLoaded", function () {
    // show evaluation popup
    if (tp_data.should_show_evaluation_form) {
        const modal = `
        <div class="tutor-modal-wrap tutor-quiz-builder-modal-wrap show">
        <div class="tutor-modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <h1>${__('Please evaluate the course', 'tutor-periscope')}</h1>
                    <p style="margin-bottom:0"><strong>Course:</strong> A Critical Thinking Approach to Medical Necessity: Power Wheelchairs</p>
                    <p style="margin-bottom:0"><strong>Instructors:</strong> Kristin McNealus, PT, DPT, MBA, ATP and Megan Rybar, PT, DPT, NCS</p>
                </div>
                <div class="modal-close-wrap">
                    <a href="javascript:;" class="modal-close-btn"><i class="tutor-icon-line-cross"></i> </a>
                </div>
            </div>
            <div class="modal-container" style="padding:20px;">
                <div class="tutor-periscope-student-course-evaluation-wrapper">
                    <form id="tutor-periscope-evaluation-form">
                        <div class="tutor-form-group mb-3 clearfix">
                            <label class="d-inline-block w-75">
                                ${__('Were the course learning objectives met?', 'tutor-periscope')}
                            </label>
                            <select name="content_matched" id="" class="tutor-form-control">
                                <option value="strongly-agree">${__('Strongly Agree', 'tutor-periscope')}</option>
                                <option value="agree">${__('Agree', 'tutor-periscope')}</option>
                                <option value="neutral">${__('Neutral', 'tutor-periscope')}</option>
                                <option value="disagree">${__('Disagree', 'tutor-periscope')}</option>
                                <option value="strongly-disagree">${__('Strongly Disagree', 'tutor-periscope')}</option>
                            </select>
                        </div>
                        <div class="tutor-form-group mb-3 clearfix">
                            <label class="d-inline-block w-75">
                                ${__('Did course content match course description?', 'tutor-periscope')}
                            </label>
                            <select name="outcome_met" id="" class="tutor-form-control">
                                <option value="strongly-agree">${__('Strongly Agree', 'tutor-periscope')}</option>
                                <option value="agree">${__('Agree', 'tutor-periscope')}</option>
                                <option value="neutral">${__('Neutral', 'tutor-periscope')}</option>
                                <option value="disagree">${__('Disagree', 'tutor-periscope')}</option>
                                <option value="strongly-disagree">${__('Strongly Disagree', 'tutor-periscope')}</option>
                            </select>
                        </div>
                        <div class="tutor-form-group mb-3 clearfix">
                            <label class="d-inline-block w-75">
                                ${__('Was current evidence provided to substantiate material presented?', 'tutor-periscope')}
                            </label>
                            <select name="specific_content" id="" class="tutor-form-control">
                                <option value="strongly-agree">${__('Strongly Agree', 'tutor-periscope')}</option>
                                <option value="agree">${__('Agree', 'tutor-periscope')}</option>
                                <option value="neutral">${__('Neutral', 'tutor-periscope')}</option>
                                <option value="disagree">${__('Disagree', 'tutor-periscope')}</option>
                                <option value="strongly-disagree">${__('Strongly Disagree', 'tutor-periscope')}</option>
                            </select>
                        </div>
                        <div class="tutor-form-group mb-3 clearfix">
                            <label class="d-inline-block w-75">
                                ${__('Were the instructors effective and knowledgeable?', 'tutor-periscope')}
                            </label>
                            <select name="added_value" id="" class="tutor-form-control">
                                <option value="strongly-agree">${__('Strongly Agree', 'tutor-periscope')}</option>
                                <option value="agree">${__('Agree', 'tutor-periscope')}</option>
                                <option value="neutral">${__('Neutral', 'tutor-periscope')}</option>
                                <option value="disagree">${__('Disagree', 'tutor-periscope')}</option>
                                <option value="strongly-disagree">${__('Strongly Disagree', 'tutor-periscope')}</option>
                            </select>
                        </div>
                        <div class="tutor-form-group mb-3 clearfix">
                            <label class="d-inline-block w-75">
                                ${__('Was the virtual learning platform supportive to learning?', 'tutor-periscope')}
                            </label>
                            <select name="effectively_delivered" id="" class="tutor-form-control">
                                <option value="strongly-agree">${__('Strongly Agree', 'tutor-periscope')}</option>
                                <option value="agree">${__('Agree', 'tutor-periscope')}</option>
                                <option value="neutral">${__('Neutral', 'tutor-periscope')}</option>
                                <option value="disagree">${__('Disagree', 'tutor-periscope')}</option>
                                <option value="strongly-disagree">${__('Strongly Disagree', 'tutor-periscope')}</option>
                            </select>
                        </div>
                        <div class="tutor-form-group mb-3 clearfix">
                            <label class="d-inline-block w-75">
                                ${__('Overall course was valuable', 'tutor-periscope')}
                            </label>
                            <select name="was_valuable" id="" class="tutor-form-control">
                                <option value="strongly-agree">${__('Strongly Agree', 'tutor-periscope')}</option>
                                <option value="agree">${__('Agree', 'tutor-periscope')}</option>
                                <option value="neutral">${__('Neutral', 'tutor-periscope')}</option>
                                <option value="disagree">${__('Disagree', 'tutor-periscope')}</option>
                                <option value="strongly-disagree">${__('Strongly Disagree', 'tutor-periscope')}</option>
                            </select>
                        </div>
                        <div class="tutor-form-group mb-3 clearfix">
                            <label class="d-inline-block w-75">
                                ${__('Would you recommend this course to a colleague?', 'tutor-periscope')}
                            </label>
                            <select name="promotion_present" id="" class="tutor-form-control">
                                <option value="strongly-agree">${__('Strongly Agree', 'tutor-periscope')}</option>
                                <option value="agree">${__('Agree', 'tutor-periscope')}</option>
                                <option value="neutral">${__('Neutral', 'tutor-periscope')}</option>
                                <option value="disagree">${__('Disagree', 'tutor-periscope')}</option>
                                <option value="strongly-disagree">${__('Strongly Disagree', 'tutor-periscope')}</option>
                            </select>
                        </div>
                        <div class="tutor-form-group mb-3 clearfix">
                            <label class="d-inline-block w-75">
                                ${__('Were personal experience and observation the primary source of information?', 'tutor-periscope')}
                            </label>
                            <select name="supportive_environment" id="" class="tutor-form-control">
                                <option value="strongly-agree">${__('Strongly Agree', 'tutor-periscope')}</option>
                                <option value="agree">${__('Agree', 'tutor-periscope')}</option>
                                <option value="neutral">${__('Neutral', 'tutor-periscope')}</option>
                                <option value="disagree">${__('Disagree', 'tutor-periscope')}</option>
                                <option value="strongly-disagree">${__('Strongly Disagree', 'tutor-periscope')}</option>
                            </select>
                        </div>
                        <div class="tutor-form-group mb-3 clearfix">
                            <label class="d-inline-block w-75">
                                ${__('Was a commercial product promoted? If yes, did you feel that the product promotion was the sole purpose of the course?', 'tutor-periscope')}
                            </label>
                            <select name="number_of_hours" id="" class="tutor-form-control">
                                <option value="yes">${__('Yes', 'tutor-periscope')}</option>
                                <option value="no">${__('No', 'tutor-periscope')}</option>
                            </select>
                        </div>
                        <div class="tutor-form-group mb-3 clearfix">
                            <label class="d-inline-block w-75">
                                ${__('What topic(s) would you like more training in? Share any additional comments or questions.', 'tutor-periscope')}
                            </label>

                            <textarea name="additional_comment"></textarea>
                        </div>
                        <div class="tutor-form-group mb-3 clearfix">
                            <button class="tutor-periscope-evaluation-submit-button tutor-button">
                                ${__('Submit', 'tutor-periscope')}
                            </button>
                        </div>
                    </form>
                </div>

            </div>
        </div>
        </div>
        <style>.nice-select{float:right;}</style>
      `;
        document.body.insertAdjacentHTML("beforeend", modal);
    }

    const reviewForm = document.getElementById("tutor-periscope-evaluation-form");
    const submitButton = document.querySelector(".tutor-periscope-evaluation-submit-button.tutor-button");
    if (submitButton) {
        submitButton.onclick = async (event) => {
            event.preventDefault();
            const formData = new FormData(reviewForm);
            formData.set('tutor_course_id', tp_data.tutor_course_id)
            formData.set("nonce", tp_data.nonce);
            formData.set("action", "tutor_periscope_evaluation");
            submitButton.innerHTML = `${__('Please wait...')}`;
            try {
                const response = await ajaxRequest(formData);
                if (response.success) {
                    submitButton.innerHTML = `${__('Thank you for evaluating')}`;
                    window.location.reload();
                } else {
                    alert(__('Evaluate submission failed', 'tutor-periscope'));
                }
            } catch (error) {
                alert(error);
            }
        };
    }
});
